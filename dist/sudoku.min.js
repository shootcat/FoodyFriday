/*! Javascript Sudoku v1.1.4 by Deniss Dubinin - https://github.com/denissdubinin/Javascript-Sudoku - Licensed MIT */

"use strict";window.sudoku={Valve:"Trilogy"},function(window,$){$.fn.Sudoku=function(options){var defaults={squareSize:3,dropTimerOnReset:!0,markWrongCellsOnFly:!1,markWrongCellsOnFinish:!0,useTimer:!0,timerOnly:!0,useCustomButtons:!1,sudokuMixIterations:500},options=$.extend({},defaults,options),sudokuTimer;function create(o){o.addClass("sudoku"),generateGui(o),init()}function init(){toggleLoadingOverlay(!0),generateMatrix(),mixMatrix(),prepareEmptyMatrix(),fillGrid(),enableFields(!1)}function generateGui(o){options.useTimer&&o.prepend('<label id="sudoku-minutes">00</label>:<label id="sudoku-seconds">00</label>'),$('<table class="table table-bordered"></table>').appendTo(o);for(var e=0,t=0;e<options.squareSize**2;){for(var n=$('<tr class="sudoku-row"></tr>').appendTo(o.find("table"));t<options.squareSize**2;)$('<td class="sudoku-cell"><input size="1" maxlength="1" onkeypress="return window.sudoku.listenKeyPress(event);"></td>').appendTo(n),t++;t=0,e++}enableFields(!1),initGridButtons(o)}function validateSudoku(o){var e=$(".sudoku-cell").find("input").filter(function(){return""===this.value});if(options.markWrongCellsOnFly){var t=$(o).parent(),n=t.parent().index(),i=t.index();parseInt($(o).val())===window.sudoku.fullMatrix[n][i]||""===$(o).val()?t.removeClass("invalid-cell"):t.addClass("invalid-cell")}if(options.markWrongCellsOnFinish&&!e.length){var s=[];$(".sudoku .sudoku-row").each(function(o){s.push([]),$(this).find("input").each(function(){s[o].push(parseInt($(this).val()))})}),checkResults(s,window.sudoku.fullMatrix)&&$(document).trigger("sudoku.success.on")}}function toggleLoadingOverlay(o){o?$(".sudoku").addClass("loading"):$(".sudoku").removeClass("loading")}function initGridButtons(o){if(!options.useCustomButtons){var e=$("<div>").addClass("btn-group"),t=$("<button>").addClass("btn btn-danger btn-sm").attr("id","r-sudoku").text("Reset sudoku"),n=$("<button>").addClass("btn btn-primary btn-sm").attr("id","gn-sudoku").text("Generate new sudoku");if(options.useTimer){var i=$("<button>").addClass("btn btn-success btn-sm").attr("id","start-sudoku").text("Start");e.append(i)}e.append(t).append(n),o.append(e)}$("body").on("click","#start-sudoku",function(){options.useTimer&&initTimer(),enableFields(!0),i.prop("disabled",!0)}),$("body").on("click","#r-sudoku",function(){1==confirm("Are you sure?")&&(fillGrid(),$(".sudoku-cell").removeClass("invalid-cell"),options.useTimer&&options.dropTimerOnReset&&resetTimer(!1))}),$("body").on("click","#gn-sudoku",function(){1==confirm("Are you sure?")&&($(document).trigger("sudoku.success.off"),$(".sudoku-cell input:disabled:not(.default-cell)").prop("disabled",!1),$(".sudoku-cell").removeClass("invalid-cell"),$(".sudoku-cell input.default-cell").removeClass("default-cell"),options.useTimer&&($("#start-sudoku:not(.default-cell)").prop("disabled",!1),resetTimer(!0)),init())})}function enableFields(o){options.timerOnly&&options.useTimer&&(o?$(".sudoku-cell input:not(.default-cell)").prop("disabled",!1):$(".sudoku-cell input:not(.default-cell)").prop("disabled",!0))}function initTimer(){var o=$("#sudoku-minutes"),e=$("#sudoku-seconds"),t=0;function n(o){var e=o+"";return e.length<2?"0"+e:e}sudokuTimer=setInterval(function(){++t,e.text(n(t%60)),o.text(n(parseInt(t/60)))},1e3)}function resetTimer(o){$("#sudoku-minutes, #sudoku-seconds").text("00"),clearInterval(sudokuTimer),o?$("#start-sudoku").prop("disabled",!1):initTimer()}function stopTimer(){clearInterval(sudokuTimer)}function generateMatrix(){var o=options.squareSize,e=[];for(let i=0;i<options.squareSize**2;i++){var t=[];for(let e=0;e<options.squareSize**2;e++){var n=(i*o+i/o+e)%(o*o)+1;t.push(parseInt(n))}e.push(t)}window.sudoku.fullMatrix=e}function fillGrid(){$(".sudoku-row").each(function(o){$(this).find("td").each(function(e){var t=window.sudoku.emptyMatrix[o][e],n=$(this).find("input");n.val(t),""!==t&&n.prop("disabled",!0).addClass("default-cell")})}),toggleLoadingOverlay(!1),$(".sudoku-cell input").off("input").on("input",function(o){validateSudoku(o.target)})}function transposeMatrix(){return window.sudoku.fullMatrix=window.sudoku.fullMatrix[0].map(function(o,e){return window.sudoku.fullMatrix.map(function(o){return o[e]})}),window.sudoku.fullMatrix}function swapTwoRows(){for(var o=Math.floor(Math.random()*options.squareSize),e=Math.floor(Math.random()*options.squareSize),t=Math.floor(Math.random()*options.squareSize),n=o*options.squareSize+e;e==t;)t=Math.floor(Math.random()*options.squareSize);var i=o*options.squareSize+t,s=window.sudoku.fullMatrix[n],u=window.sudoku.fullMatrix[i];return window.sudoku.fullMatrix[n]=u,window.sudoku.fullMatrix[i]=s,window.sudoku.fullMatrix}function swapTwoColumns(){transposeMatrix(),swapTwoRows(),transposeMatrix()}function swapTwoLargeRows(){for(var o=Math.floor(Math.random()*options.squareSize),e=Math.floor(Math.random()*options.squareSize);o==e;)e=Math.floor(Math.random()*options.squareSize);for(let u=0;u<options.squareSize;u++){var t=o*options.squareSize+u,n=e*options.squareSize+u,i=window.sudoku.fullMatrix[t],s=window.sudoku.fullMatrix[n];window.sudoku.fullMatrix[t]=s,window.sudoku.fullMatrix[n]=i}return window.sudoku.fullMatrix}function swapTwoLargeColumns(){transposeMatrix(),swapTwoLargeRows(),transposeMatrix()}function mixMatrix(){var t0=performance.now(),logicFunctions=["transposeMatrix()","swapTwoRows()","swapTwoRows()","swapTwoColumns()","swapTwoColumns()","swapTwoLargeRows()","swapTwoLargeColumns()"];let i=0;for(;i<options.sudokuMixIterations;){var randomFunction=Math.floor(Math.random()*logicFunctions.length);eval(logicFunctions[randomFunction]),i++}var t1=performance.now();window.sudoku.generationTime=(.001*(t1-t0)).toFixed(5)+" seconds."}function prepareEmptyMatrix(){window.sudoku.emptyMatrix=[];for(let o=0;o<options.squareSize*options.squareSize;o++){window.sudoku.emptyMatrix.push([]);for(let e=0;e<options.squareSize*options.squareSize;e++)window.sudoku.emptyMatrix[o].push("")}let o=0;for(;o<options.squareSize**4;){let e=Math.floor(Math.random()*options.squareSize**2),t=Math.floor(Math.random()*options.squareSize**2);""===window.sudoku.emptyMatrix[e][t]&&(o++,10*Math.random()>6&&(window.sudoku.emptyMatrix[e][t]=window.sudoku.fullMatrix[e][t]))}}function checkResults(o,e){let t=!1;for(let i=0;i<o.length;i++)for(let s=0;s<o.length;s++){var n=$(`.sudoku-row:eq(${i}) .sudoku-cell:eq(${s})`);o[i][s]!==e[i][s]?(t=!0,options.markWrongCellsOnFinish&&n.addClass("invalid-cell")):n.removeClass("invalid-cell")}return!t}create($(this)),window.sudoku.listenKeyPress=function(o){var e=window.event?o.keyCode:o.which;return 8==o.keyCode||46==o.keyCode||e>47&&e<58}}}(window,jQuery);